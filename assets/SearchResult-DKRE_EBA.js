import{u as $,h as ee,i as se,j,k as te,l as ae,t as le,m as oe,n as L,p as H,q as re,w as ie,v as t,x as ue,R as b,y as ne,z as pe,A as ce,D as me,B as he,C as ve,E as ye,F as Ee,G as de,H as S,I as ge,J as Ae,K as Ce,L as fe,M as F,N as O,O as Be}from"./app-Cpaph37u.js";const He=["/","/intro.html","/posts/ECMA/CodeExecution.html","/posts/ECMA/HostEnvironment.html","/posts/ECMA/Precompilation.html","/posts/ECMA/","/posts/ECMA/Scope.html","/posts/ECMA/understand.html","/posts/JS/","/posts/HTML5/R.html","/posts/HTML5/","/posts/PHP/constants.html","/posts/PHP/control-structures.html","/posts/PHP/functions.html","/posts/PHP/introduce.html","/posts/PHP/oop.html","/posts/PHP/operators.html","/posts/PHP/type.html","/posts/PHP/variables.html","/posts/Typescipt/","/posts/VersionControl/git.html","/posts/Vue/404.html","/posts/Vue/Component-communication.html","/posts/Vue/Modifiers.html","/posts/Vue/RABC.html","/posts/Vue/SPA.html","/posts/Vue/Virtual-DOM.html","/posts/Vue/auto-propetry.html","/posts/Vue/component-plugin.html","/posts/Vue/cors.html","/posts/Vue/data.html","/posts/Vue/diff.html","/posts/Vue/directive.html","/posts/Vue/err-handler.html","/posts/Vue/filter.html","/posts/Vue/if-for.html","/posts/Vue/keep-alive.html","/posts/Vue/key.html","/posts/Vue/life-cycle.html","/posts/Vue/mixin.html","/posts/Vue/mounted.html","/posts/Vue/nextTick.html","/posts/Vue/slot.html","/posts/Vue/vue.html","/posts/Vue/vue3.html","/posts/WX/","/posts/performance/CallOpt.html","/posts/performance/LoadingOpt.html","/posts/performance/","/posts/performance/ResourceOpt.html","/posts/performance/SSG.html","/posts/performance/SSR.html","/posts/performance/UserOpt.html","/posts/performance/renderOpt.html","/posts/webpack/Configuration.html","/posts/webpack/","/posts/webpack/loader.html","/posts/webpack/plugins.html","/posts/ECMA/DataTypes/","/posts/ECMA/Operate/","/posts/ECMA/Operate/RuntimeSemantics.html","/posts/ECMA/Operate/term.html","/posts/ECMA/SyntaxAndLexicology/Parameters.html","/posts/ECMA/SyntaxAndLexicology/","/posts/ECMA/SyntaxAndLexicology/symbol.html","/posts/HTML5/canvas/","/posts/HTML5/canvas/canvas.html","/posts/ECMA/DataTypes/LanguageTypes/","/posts/ECMA/DataTypes/SpecificationTypes/","/posts/ECMA/DataTypes/LanguageTypes/String/","/posts/ECMA/DataTypes/LanguageTypes/String/String.html","/404.html","/posts/","/posts/PHP/","/posts/VersionControl/","/posts/Vue/","/category/","/category/ecma%E6%A0%87%E5%87%86/","/category/javascript/","/category/htnl/","/category/h5/","/category/php/","/category/js%E6%A1%86%E6%9E%B6/","/category/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%B7%A5%E5%85%B7/","/category/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/","/category/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/","/category/canvas/","/tag/","/tag/%E4%BD%9C%E7%94%A8%E5%9F%9F/","/tag/php/","/tag/typescript/","/tag/git/","/tag/vue/","/tag/%E5%B0%8F%E7%A8%8B%E5%BA%8F/","/tag/%E9%98%B2%E6%8A%96/","/tag/%E8%8A%82%E6%B5%81/","/tag/%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98/","/tag/%E6%8C%89%E9%9C%80%E5%8A%A0%E8%BD%BD/","/tag/%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD/","/tag/%E7%BC%93%E5%AD%98/","/tag/%E5%8E%8B%E7%BC%A9/","/tag/ssg/","/tag/ssr/","/tag/%E5%B1%80%E9%83%A8ssr/","/tag/%E9%A2%84%E6%B8%B2%E6%9F%93/","/tag/%E9%A2%84%E5%8A%A0%E8%BD%BD/","/tag/%E9%AA%A8%E6%9E%B6%E5%B1%8F/","/tag/canvas/","/tag/webpack/","/tag/ecma/","/article/","/star/","/timeline/"],Se="SLIMSEARCH_QUERY_HISTORY",E=$(Se,[]),Ve=()=>{const{queryHistoryCount:a}=S,l=a>0;return{enabled:l,queryHistories:E,addQueryHistory:o=>{l&&(E.value=Array.from(new Set([o,...E.value.slice(0,a-1)])))},removeQueryHistory:o=>{E.value=[...E.value.slice(0,o),...E.value.slice(o+1)]}}},w=a=>He[a.id]+("anchor"in a?`#${a.anchor}`:""),Me="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:I}=S,d=$(Me,[]),ke=()=>{const a=I>0;return{enabled:a,resultHistories:d,addResultHistory:l=>{if(a){const o={link:w(l),display:l.display};"header"in l&&(o.header=l.header),d.value=[o,...d.value.slice(0,I-1)]}},removeResultHistory:l=>{d.value=[...d.value.slice(0,l),...d.value.slice(l+1)]}}},xe=a=>{const l=me(),o=j(),V=he(),i=L(0),A=H(()=>i.value>0),v=ve([]);return ye(()=>{const{search:y,terminate:M}=Ee(),g=de(n=>{const{resultsFilter:C=u=>u,querySplitter:T,suggestionsFilter:k,...x}=l.value;n?(i.value+=1,y(n,o.value,x).then(u=>C(u,n,o.value,V.value)).then(u=>{i.value-=1,v.value=u}).catch(u=>{console.warn(u),i.value-=1,i.value||(v.value=[])})):v.value=[]},S.searchDelay-S.suggestDelay,{maxWait:5e3});ge([a,o],([n])=>g(n.join(" "))),Ae(()=>{M()})}),{isSearching:A,results:v}};var Re=ee({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:l}){const o=se(),V=j(),i=te(ae),{enabled:A,addQueryHistory:v,queryHistories:y,removeQueryHistory:M}=Ve(),{enabled:g,resultHistories:n,addResultHistory:C,removeResultHistory:T}=ke(),k=A||g,x=le(a,"queries"),{results:u,isSearching:U}=xe(x),r=oe({isQuery:!0,index:0}),m=L(0),h=L(0),q=H(()=>k&&(y.value.length>0||n.value.length>0)),D=H(()=>u.value.length>0),R=H(()=>u.value[m.value]||null),_=()=>{const{isQuery:e,index:s}=r;s===0?(r.isQuery=!e,r.index=e?n.value.length-1:y.value.length-1):r.index=s-1},Y=()=>{const{isQuery:e,index:s}=r;s===(e?y.value.length-1:n.value.length-1)?(r.isQuery=!e,r.index=0):r.index=s+1},G=()=>{m.value=m.value>0?m.value-1:u.value.length-1,h.value=R.value.contents.length-1},J=()=>{m.value=m.value<u.value.length-1?m.value+1:0,h.value=0},W=()=>{h.value<R.value.contents.length-1?h.value+=1:J()},z=()=>{h.value>0?h.value-=1:G()},P=e=>e.map(s=>Be(s)?s:t(s[0],s[1])),K=e=>{if(e.type==="customField"){const s=Ce[e.index]||"$content",[p,B=""]=fe(s)?s[V.value].split("$content"):s.split("$content");return e.display.map(c=>t("div",P([p,...c,B])))}return e.display.map(s=>t("div",P(s)))},f=()=>{m.value=0,h.value=0,l("updateQuery",""),l("close")},N=()=>A?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},i.value.queryHistory),y.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:r.isQuery&&r.index===s}],onClick:()=>{l("updateQuery",e)}},[t(F,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:O,onClick:p=>{p.preventDefault(),p.stopPropagation(),M(s)}})]))])):null,X=()=>g?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},i.value.resultHistory),n.value.map((e,s)=>t(b,{to:e.link,class:["slimsearch-result-item",{active:!r.isQuery&&r.index===s}],onClick:()=>{f()}},()=>[t(F,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(p=>P(p)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:O,onClick:p=>{p.preventDefault(),p.stopPropagation(),T(s)}})]))])):null;return re("keydown",e=>{if(a.isFocusing){if(D.value){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")W();else if(e.key==="Enter"){const s=R.value.contents[h.value];v(a.queries.join(" ")),C(s),o.push(w(s)),f()}}else if(g){if(e.key==="ArrowUp")_();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:s}=r;r.isQuery?(l("updateQuery",y.value[s]),e.preventDefault()):(o.push(n.value[s].link),f())}}}}),ie([m,h],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:a.queries.length?!D.value:!q.value}],id:"slimsearch-results"},a.queries.length?U.value?t(ue,{hint:i.value.searching}):D.value?t("ul",{class:"slimsearch-result-list"},u.value.map(({title:e,contents:s},p)=>{const B=m.value===p;return t("li",{class:["slimsearch-result-list-item",{active:B}]},[t("div",{class:"slimsearch-result-title"},e||i.value.defaultTitle),s.map((c,Z)=>{const Q=B&&h.value===Z;return t(b,{to:w(c),class:["slimsearch-result-item",{active:Q,"aria-selected":Q}],onClick:()=>{v(a.queries.join(" ")),C(c),f()}},()=>[c.type==="text"?null:t(c.type==="title"?ne:c.type==="heading"?pe:ce,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[c.type==="text"&&c.header?t("div",{class:"content-header"},c.header):null,t("div",K(c))])])})])})):i.value.emptyResult:k?q.value?[N(),X()]:i.value.emptyHistory:i.value.emptyResult)}});export{Re as default};
